{"data":{"markdownRemark":{"html":"<p>This post is part 8 of a series on bioinformatics file formats, written for the 2017 UK-KBRIN Essentials of Next Generation Sequencing Workshop at the University of Kentucky.</p>\n<h3>Bowtie output</h3>\n<p><a href=\"http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml\">The Bowtie 2 manual is available here</a>.</p>\n<p>Bowtie 2 outputs SAM format.  A detailed explanation of the SAM format output is available <a href=\"http://samtools.sourceforge.net/SAM1.pdf\">here</a>.</p>\n<h3>Example output</h3>\n<p>This example output is from <a href=\"http://genome.sph.umich.edu/wiki/SAM\">the University of Michigan Center for Statistical Genomics</a></p>\n<h4>Header</h4>\n<pre><code>@HD VN:1.0  SO:coordinate\n@SQ SN:1    LN:249250621    AS:NCBI37   UR:file:/data/local/ref/GATK/human_g1k_v37.fasta    M5:1b22b98cdeb4a9304cb5d48026a85128\n@SQ SN:2    LN:243199373    AS:NCBI37   UR:file:/data/local/ref/GATK/human_g1k_v37.fasta    M5:a0d9851da00400dec1098a9255ac712e\n@SQ SN:3    LN:198022430    AS:NCBI37   UR:file:/data/local/ref/GATK/human_g1k_v37.fasta    M5:fdfd811849cc2fadebc929bb925902e5\n@RG ID:UM0098:1 PL:ILLUMINA PU:HWUSI-EAS1707-615LHAAXX-L001 LB:80   DT:2010-05-05T20:00:00-0400 SM:SD37743  CN:UMCORE\n@RG ID:UM0098:2 PL:ILLUMINA PU:HWUSI-EAS1707-615LHAAXX-L002 LB:80   DT:2010-05-05T20:00:00-0400 SM:SD37743  CN:UMCORE\n@PG ID:bwa  VN:0.5.4\n@PG ID:GATK TableRecalibration  VN:1.0.3471 CL:Covariates=[ReadGroupCovariate, QualityScoreCovariate, CycleCovariate, DinucCovariate, TileCovariate], default_read_group=null, default_platform=null, force_read_group=null, force_platform=null, solid_recal_mode=SET_Q_ZERO, window_size_nqs=5, homopolymer_nback=7, exception_if_no_tile=false, ignore_nocall_colorspace=false, pQ=5, maxQ=40, smoothing=1\n</code></pre>\n<h4>Body</h4>\n<p>The below example shows four alignments in SAM format.</p>\n<pre><code>1:497:R:-272+13M17D24M  113 1   497 37  37M 15  100338662   0   CGGGTCTGACCTGAGGAGAACTGTGCTCCGCCTTCAG   0;==-==9;>>>>>=>>>>>>>>>>>=>>>>>>>>>>   XT:A:U  NM:i:0  SM:i:37 AM:i:0  X0:i:1  X1:i:0  XM:i:0  XO:i:0  XG:i:0  MD:Z:37\n19:20389:F:275+18M2D19M 99  1   17644   0   37M =   17919   314 TATGACTGCTAATAATACCTACACATGTTAGAACCAT   >>>>>>>>>>>>>>>>>>>>&#x3C;&#x3C;>>>&#x3C;&#x3C;>>4::>>:&#x3C;9   RG:Z:UM0098:1   XT:A:R  NM:i:0  SM:i:0  AM:i:0  X0:i:4  X1:i:0  XM:i:0  XO:i:0  XG:i:0  MD:Z:37\n19:20389:F:275+18M2D19M 147 1   17919   0   18M2D19M    =   17644   -314    GTAGTACCAACTGTAAGTCCTTATCTTCATACTTTGT   ;44999;499&#x3C;8&#x3C;8&#x3C;&#x3C;&#x3C;8&#x3C;&#x3C;>&#x3C;&#x3C;&#x3C;&#x3C;>&#x3C;7&#x3C;;&#x3C;&#x3C;&#x3C;>>&#x3C;&#x3C;   XT:A:R  NM:i:2  SM:i:0  AM:i:0  X0:i:4  X1:i:0  XM:i:0  XO:i:1  XG:i:2  MD:Z:18^CA19\n9:21597+10M2I25M:R:-209 83  1   21678   0   8M2I27M =   21469   -244    CACCACATCACATATACCAAGCCTGGCTGTGTCTTCT   &#x3C;;9&#x3C;&#x3C;5>&#x3C;&#x3C;&#x3C;&#x3C;>&#x3C;&#x3C;&#x3C;>>&#x3C;&#x3C;>&#x3C;>>&#x3C;9>>&#x3C;>>>9>>>&#x3C;>   XT:A:R  NM:i:2  SM:i:0  AM:i:0  X0:i:5  X1:i:0  XM:i:0  XO:i:1  XG:i:2  MD:Z:35\n</code></pre>\n<p>Let's look at just the first alignment.</p>\n<p>The below table describes each field for the first alignment.</p>\n<table>\n<thead>\n<tr>\n<th>Field</th>\n<th>Alignment 1 Value</th>\n<th>description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>QNAME</td>\n<td>1:497:R:-272+13M17D24M</td>\n<td>Query name</td>\n</tr>\n<tr>\n<td>FLAG</td>\n<td>113</td>\n<td>A bitwise FLAG.</td>\n</tr>\n<tr>\n<td>RNAME</td>\n<td>1</td>\n<td>Reference name</td>\n</tr>\n<tr>\n<td>POS</td>\n<td>497</td>\n<td>Lefmost mapping position</td>\n</tr>\n<tr>\n<td>MAPQ</td>\n<td>37</td>\n<td>Mapping quality</td>\n</tr>\n<tr>\n<td>CIGAR</td>\n<td>37M</td>\n<td>CIGAR string ( see below)</td>\n</tr>\n<tr>\n<td>MRNM/RNEXT</td>\n<td>15</td>\n<td>Reference of the mate/next read</td>\n</tr>\n<tr>\n<td>MPOS/PNEXT</td>\n<td>100338662</td>\n<td>Position of mate/next read</td>\n</tr>\n<tr>\n<td>ISIZE/TLEN</td>\n<td>0</td>\n<td>Template length</td>\n</tr>\n<tr>\n<td>SEQ</td>\n<td>CGGGTCTGACCTGAGGAGAACTGTGCTCCGCCTTCAG</td>\n<td>Sequence</td>\n</tr>\n<tr>\n<td>QUAL</td>\n<td>0;==-==9;>>>>>=>>>>>>>>>>>=>>>>>>>>>></td>\n<td>Phred-based quality score</td>\n</tr>\n<tr>\n<td>TAGS</td>\n<td>XT:A:U\tNM:i:0\tSM:i:37\tAM:i:0\tX0:i:1\tX1:i:0\tXM:i:0\tXO:i:0 XG:i:0\tMD:Z:37</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h4>FLAGs, CIGARs, and TAGS</h4>\n<p>The FLAG, CIGAR, and TAGS fields all describe metadata associated with the alignment.  It's likely that if you are interested in this information, you will search for a particular code, or perhaps will want to translate a code.  To that end, there are tools available to decode these fields.  For example, the broad institute has a <a href=\"https://broadinstitute.github.io/picard/explain-flags.html\">FLAG-decoder in picard tools</a> that can convert FLAGs into human readable properties.</p>\n<p>The FLAG and CIGAR fields are included as seperate apendices in the workshop.</p>\n<h5>TAGs</h5>\n<p>TAGs take the form <code>[A-Za-z][A-za-z]:[AifZH]:.*</code>.  </p>","frontmatter":{"title":"Examining bowtie output"}}},"pageContext":{"slug":"/2017-07-13-bowtie2/"}}